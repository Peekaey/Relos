@using System.ComponentModel.DataAnnotations
@using Radzen
@using Radzen.Blazor
@using Relos.Models.RequestDtos
@inject DialogService DialogService
@rendermode InteractiveServer

<RadzenTemplateForm TItem="CreateWorkspaceRequest" Data="@model" Submit="@OnValidSubmit">
    <DataAnnotationsValidator />
    
    <RadzenStack Gap="1rem">
        <RadzenFormField Text="Workspace Name" Variant="Variant.Outlined">
            <RadzenTextBox @bind-Value="@model.Name" 
                          Class="w-100" 
                          Placeholder="Enter workspace name"
                          Name="Name" />
            <RadzenRequiredValidator Component="Name" Text="Workspace name is required" />
            <RadzenLengthValidator Component="Name" Max="50" 
                                 Text="Name length can't be more than 50 characters." />
        </RadzenFormField>

        <RadzenFormField Text="Description" Variant="Variant.Outlined">
            <RadzenTextArea @bind-Value="@model.Description" 
                           Rows="3" 
                           Class="w-100"
                           Placeholder="Enter description (optional)"
                           Name="Description" />
            <RadzenLengthValidator Component="Description" Max="200" 
                                 Text="Description length can't be more than 200 characters." />
        </RadzenFormField>

        <RadzenStack Orientation="Orientation.Horizontal" 
                    JustifyContent="JustifyContent.End" 
                    Gap="0.5rem" 
                    Class="rz-mt-4">
            <RadzenButton Text="Cancel" 
                         ButtonStyle="ButtonStyle.Light" 
                         Click="@Cancel" />
            <RadzenButton Text="Create Workspace" 
                         ButtonStyle="ButtonStyle.Primary" 
                         ButtonType="ButtonType.Submit" />
        </RadzenStack>
    </RadzenStack>
</RadzenTemplateForm>

@code {
    private CreateWorkspaceRequest model = new();

    protected override void OnInitialized()
    {
        model = new CreateWorkspaceRequest();
    }

    private void Cancel()
    {
        DialogService.Close(false);
    }

    private async Task OnValidSubmit()
    {
        // TODO Review and add validation logic if needed
        var request = new CreateWorkspaceRequest
        {
            Name = model.Name?.Trim() ?? string.Empty,
            Description = model.Description?.Trim() ?? string.Empty
        };

        DialogService.Close(request);
    }
    
}